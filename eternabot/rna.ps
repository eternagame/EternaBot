%!PS-Adobe-3.0 EPSF-3.0
%%Creator: PS_dot.c,v 1.38 2007/02/02 15:18:13 ivo Exp $, ViennaRNA-1.8.4
%%CreationDate: Mon Jan 19 15:56:28 2015
%%Title: RNA Secondary Structure Plot
%%BoundingBox: 66 210 518 662
%%DocumentFonts: Helvetica
%%Pages: 1
%%EndComments

%Options: 
% to switch off outline pairs of sequence comment or
% delete the appropriate line near the end of the file

%%BeginProlog
/RNAplot 100 dict def
RNAplot begin
/fsize  14 def
/outlinecolor {0.2 setgray} bind def
/paircolor    {0.2 setgray} bind def
/seqcolor     {0   setgray} bind def
/cshow  { dup stringwidth pop -2 div fsize -3 div rmoveto show} bind def
/min { 2 copy gt { exch } if pop } bind def
/max { 2 copy lt { exch } if pop } bind def
/drawoutline {
  gsave outlinecolor newpath
  coor 0 get aload pop 0.8 0 360 arc % draw 5' circle of 1st sequence
  currentdict /cutpoint known        % check if cutpoint is defined
  {coor 0 cutpoint getinterval
   {aload pop lineto} forall         % draw outline of 1st sequence
   coor cutpoint 1 add get aload pop
   2 copy moveto 0.8 0 360 arc       % draw 5' circle of 2nd sequence
   coor cutpoint 1 add coor length cutpoint 1 add sub getinterval
   {aload pop lineto} forall}        % draw outline of 2nd sequence
  {coor {aload pop lineto} forall}   % draw outline as a whole
  ifelse
  stroke grestore
} bind def
/drawpairs {
  paircolor
  0.7 setlinewidth
  [9 3.01] 9 setdash
  newpath
  pairs {aload pop
     coor exch 1 sub get aload pop moveto
     coor exch 1 sub get aload pop lineto
  } forall
  stroke
} bind def
% draw bases
/drawbases {
  [] 0 setdash
  seqcolor
  0
  coor {
    aload pop moveto
    dup sequence exch 1 getinterval cshow
    1 add
  } forall
  pop
} bind def

/init {
  /Helvetica findfont fsize scalefont setfont
  1 setlinejoin
  1 setlinecap
  0.8 setlinewidth
  72 216 translate
  % find the coordinate range
  /xmax -1000 def /xmin 10000 def
  /ymax -1000 def /ymin 10000 def
  coor {
      aload pop
      dup ymin lt {dup /ymin exch def} if
      dup ymax gt {/ymax exch def} {pop} ifelse
      dup xmin lt {dup /xmin exch def} if
      dup xmax gt {/xmax exch def} {pop} ifelse
  } forall
  /size {xmax xmin sub ymax ymin sub max} bind def
  72 6 mul size div dup scale
  size xmin sub xmax sub 2 div size ymin sub ymax sub 2 div
  translate
} bind def
end
RNAplot begin
% extra definitions for standard anotations
/min { 2 copy gt { exch } if pop } bind def
/BLACK { 0 0 0 } def
/RED   { 1 0 0 } def
/GREEN { 0 1 0 } def
/BLUE  { 0 0 1 } def
/WHITE { 1 1 1 } def
/LabelFont { % font size LabelFont
   exch findfont exch fsize mul scalefont setfont
} bind def
/Label { % i dx dy (text) Label
   % write text at base i plus offset dx, dy
   4 3 roll 1 sub coor exch get aload pop moveto
   3 1 roll fsize mul exch fsize mul exch rmoveto
   show
} bind def
/cmark { % i cmark   draw circle around base i
   newpath 1 sub coor exch get aload pop
   fsize 2 div 0 360 arc stroke
} bind def
/gmark { % i j c cmark
   % draw basepair i,j with c counter examples in gray
   gsave
   3 min [0 0.33 0.66 0.9] exch get setgray
   1 sub dup coor exch get aload pop moveto
   sequence exch 1 getinterval cshow
   1 sub dup coor exch get aload pop moveto
   sequence exch 1 getinterval cshow
   grestore
} bind def
/segmark { % f i j lw r g b segmark
   % mark segment [i,j] with outline width lw and color rgb
   % use omark and Fomark instead
   gsave
    setrgbcolor setlinewidth
    newpath
    1 sub exch 1 sub dup
    coor exch get aload pop moveto
    exch 1 exch {
	    coor exch get aload pop lineto
    } for
    { closepath fill } if  stroke
   grestore
} bind def
/omark { % i j lw r g b omark
   % stroke segment [i..j] with linewidth lw, color rgb
   false 7 1 roll segmark
} bind def
/Fomark { % i j r g b Fomark
   % fill segment [i..j] with color rgb
   % should precede drawbases
   1 4 1 roll true 7 1 roll segmark
} bind def
/BFmark{ % i j k l r g b BFmark
   % fill block between pairs (i,j) and (k,l) with color rgb
   % should precede drawbases
   gsave
    setrgbcolor
    newpath
    exch 4 3 roll exch 1 sub exch 1 sub dup
    coor exch get aload pop moveto
    exch 1 exch { coor exch get aload pop lineto } for
    exch 1 sub exch 1 sub dup
    coor exch get aload pop lineto
    exch 1 exch { coor exch get aload pop lineto } for
    closepath fill stroke
   grestore
} bind def
/hsb {
    dup 0.3 mul 1 exch sub sethsbcolor
} bind def
/colorpair { % i j hue sat colorpair
   % draw basepair i,j in color
   % 1 index 0.00 ne {
   gsave
   newpath
   hsb
   fsize setlinewidth
   1 sub coor exch get aload pop moveto
   1 sub coor exch get aload pop lineto
   stroke
   grestore
   % } if
} bind def
end

%%EndProlog
RNAplot begin
% data start here
/cutpoint 100 def
/sequence (\
CCGCAGAUUAACACAAAAUGCGAUUAUCCUCACAGACCCACAUGAGGAUCACCCAUGUGCCCGUAUGCCCACGUAUUUAUUUGGAAGCCGUUCGUUAUAA AUAAGACGAGCAAAAAGCUUGUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUUU\
) def
/coor [
[106.717 150.265]
[108.407 135.357]
[102.241 149.032]
[96.076 162.706]
[89.910 176.380]
[100.079 187.717]
[104.750 202.212]
[103.116 217.353]
[95.459 230.517]
[83.107 239.423]
[68.198 242.529]
[53.316 239.296]
[41.040 230.284]
[33.496 217.055]
[31.991 201.901]
[36.787 187.446]
[47.052 176.197]
[61.008 170.101]
[76.236 170.215]
[82.402 156.541]
[88.567 142.866]
[94.733 129.192]
[92.016 122.201]
[78.034 127.634]
[72.602 113.652]
[86.583 108.220]
[83.866 101.229]
[70.085 95.306]
[56.304 89.383]
[47.387 100.444]
[35.922 108.813]
[22.694 113.926]
[8.608 115.442]
[-5.377 113.264]
[-18.311 107.547]
[-29.314 98.687]
[-37.643 87.293]
[-42.735 74.145]
[-44.250 60.140]
[-59.062 57.767]
[-73.873 55.395]
[-88.684 53.022]
[-103.495 50.649]
[-118.306 48.277]
[-127.306 50.012]
[-133.357 45.729]
[-148.124 43.096]
[-163.353 49.180]
[-176.067 38.823]
[-173.188 22.678]
[-157.677 17.355]
[-145.490 28.329]
[-130.723 30.962]
[-115.934 33.466]
[-101.122 35.838]
[-86.311 38.211]
[-71.500 40.584]
[-56.689 42.956]
[-41.878 45.329]
[-39.800 39.705]
[-37.111 34.346]
[-33.844 29.319]
[-30.040 24.685]
[-39.568 13.100]
[-49.097 1.515]
[-58.626 -10.069]
[-68.154 -21.654]
[-83.690 -26.904]
[-86.646 -43.035]
[-73.981 -53.452]
[-58.724 -47.440]
[-56.570 -31.183]
[-47.041 -19.598]
[-37.512 -8.013]
[-27.984 3.571]
[-18.455 15.156]
[-1.452 8.319]
[16.884 7.562]
[34.441 12.990]
[49.191 23.992]
[59.425 39.316]
[63.949 57.205]
[62.227 75.602]
[76.008 81.525]
[89.789 87.448]
[80.057 76.034]
[83.725 61.489]
[97.707 56.056]
[110.233 64.308]
[110.762 79.298]
[116.927 65.624]
[123.093 51.950]
[129.258 38.275]
[135.423 24.601]
[141.589 10.927]
[147.754 -2.748]
[139.265 -15.629]
[139.111 -31.056]
[147.341 -44.105]
[161.329 -50.612]
[176.611 -48.501]
[188.311 -38.446]
[192.696 -23.655]
[188.366 -8.848]
[176.703 1.251]
[161.429 3.418]
[155.263 17.092]
[149.098 30.766]
[142.932 44.441]
[136.767 58.115]
[130.601 71.789]
[124.436 85.464]
[131.743 72.364]
[140.172 59.956]
[149.657 48.336]
[160.126 37.593]
[171.496 27.810]
[183.682 19.062]
[196.587 11.418]
[210.114 4.936]
[224.158 -0.335]
[238.610 -4.352]
[253.359 -7.086]
[268.291 -8.515]
[283.290 -8.628]
[298.242 -7.424]
[313.030 -4.913]
[327.541 -1.114]
[341.663 3.944]
[355.286 10.222]
[368.306 17.671]
[380.621 26.233]
[392.138 35.844]
[402.767 46.428]
[412.426 57.904]
[421.041 70.183]
[428.545 83.171]
[434.881 96.768]
[439.998 110.868]
[443.859 125.363]
[446.433 140.140]
[447.700 155.087]
[447.650 170.086]
[446.285 185.024]
[443.613 199.784]
[439.657 214.253]
[434.447 228.319]
[428.022 241.873]
[420.432 254.812]
[411.736 267.034]
[402.001 278.446]
[391.303 288.960]
[379.723 298.494]
[367.351 306.975]
[354.282 314.338]
[340.618 320.526]
[326.463 325.490]
[311.927 329.194]
[297.123 331.607]
[282.164 332.712]
[267.165 332.500]
[252.243 330.972]
[237.513 328.141]
[223.088 324.029]
[209.079 318.666]
[195.595 312.094]
[182.740 304.365]
[170.613 295.537]
[159.307 285.679]
[148.910 274.867]
[139.501 263.185]
[131.155 250.721]
[123.934 237.574]
[117.895 223.843]
[113.084 209.636]
[109.538 195.061]
[107.285 180.231]
] def
/pairs [
[2 22]
[3 21]
[4 20]
[5 19]
[27 85]
[28 84]
[29 83]
[39 59]
[40 58]
[41 57]
[42 56]
[43 55]
[44 54]
[46 53]
[47 52]
[63 76]
[64 75]
[65 74]
[66 73]
[67 72]
[90 112]
[91 111]
[92 110]
[93 109]
[94 108]
[95 107]
[96 106]
] def

init

% Start Annotations
1 100 9  0 0.9 0.2 omark
102 177 9  1 0.1 0.2 omark

% End Annotations
% switch off outline pairs or bases by removing these lines
drawoutline
drawpairs
drawbases
% show it
showpage
end
%%EOF
